<h1>レビューの作成</h1>
<% if @review.errors.any? %>
    <div id="error_explanation">
      <ul>
      <% @review.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
<% end %>

<%= form_with(model: @review, url: another_reviews_path,method: :post, local: true) do |f| %>
  <%= f.hidden_field :isbn, value: params[:isbn] %>

  <div class="review_title">
    <p><%= f.label :title %></p>
    <p><%= f.text_field :title %></p>
  </div>

  <div class="review_content">
    <p><%= f.label :content %></p>
    <p><%= f.text_area :content %></p>
  </div>


  <%= f.fields_for :ratings, @review.ratings do |rating_form| %>
    <%= rating_form.hidden_field :user_id, value: current_user.id %>
    <div class="rating_category">
      <p><%= rating_form.label :category %></p>
      <p><%= rating_form.collection_select(:category_id,Category.all,:id,:name) %></p>
    </div>

    <div id="rating_point_<%= rating_form.index %>">
      <p><%= rating_form.label :point %></p>
      <p><%= rating_form.hidden_field  :point %></p>
    </div>
      <script>
      $('#rating_point_<%= rating_form.index %>').empty();
      $('#rating_point_<%= rating_form.index %>').raty({
        size :36,
        starHalf: '<%= asset_path('star-half.png') %>',
        starOff: '<%= asset_path('star-off.png') %>',
        starOn: '<%= asset_path('star-on.png') %>',
        scoreName: '<%= "review[ratings_attributes][#{rating_form.index}][point]" %>',
        half: true
      });
      </script>
  <% end %>
  <%= f.submit '登録する' %>
<% end %>
